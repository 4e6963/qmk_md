#ifdef RGB_MATRIX_ENABLE
#include "shift.h"

#include "led_matrix.h"
#include "rgb_matrix.h"
#include "config_led.h"

// This table can be almost-automatically derived from ISSI3733_LED_MAP that is
// defined in config_led.h
//
// scan in the following equations refers to the scan variable of ISSI3733_LED_MAP
//   col = (uint8_t)(scan / 8)
//   row = (uint8_t)(scan % 8)
//
// You can calculate the (0-244, 0-64) x/y values from the x/y values defined in
// ISSI3733_LED_MAP with the following formula:
//   uint8_t rgb_x = ((ISSI3733_LED_MAP[i].x - MIN_X) / (MAX_X - MIN_X)) * 224;
//   uint8_t rgb_y = ((ISSI3733_LED_MAP[i].y - MIN_Y) / (MAX_Y - MIN_Y)) * 64; //TODO: 64 - this?
// Where the min/max vars are the minimum and maximum "bounds" of x/y values
// present in ISSI3733_LED_MAP
//
// The row/col values need to be manually tweaked though, compensating for the
// "empty" cells that are a product of larger keys
//


/*

LED IDs

0  -> ESC
1  -> F1
2  -> F2
3  -> F3
4  -> F4
5  -> F5
6  -> F6
7  -> F7
8  -> F8
9  -> F9
10 -> F10
11 -> F11
12 -> F12
13 -> HOME
14 -> PG_UP
15 -> DEL
16 -> END
17 -> PG_DN
18 ->
19 -> 1
20 -> 2
21 -> 3
22 -> 4
23 -> 5
24 -> 6
25 -> 7
26 -> 8
27 -> 9
28 -> 0
29 -> -
30 -> =
31 -> BACKSPACE
32 -> NUMLOCK
33 -> N/
34 -> *
35 -> Print
36 -> TAB
37 -> Q
38 -> W
39 -> E
40 -> R
41 -> T
42 -> Y
43 -> U
44 -> I
45 -> O
46 -> P
47 -> [
48 -> ]
49 -> \
50 -> N7
51 -> N8
52 -> N9
53 -> N-
54 -> CAPSLOCK
55 -> A
56 -> S
57 -> D
58 -> F
59 -> G
60 -> H
61 -> J
62 -> K
63 -> L
64 -> ;
65 -> '
66 -> RETURN
67 -> N4
68 -> N5
69 -> N6
70 -> N+
71 -> SHIFT
72 -> z
73 -> x
74 -> C
75 -> V
76 -> B
77 -> N
78 -> M
79 -> ,
80 -> .
81 -> /
82 -> RSHIFT
83 -> 1
84 -> 2
85 -> 3
86 -> UP
87 -> NRETURN
88 -> CTRL
89 -> META
90 -> ALT
91 -> SPACE
92 -> RALT
93 -> FN
94 -> N0
95 -> N.
96 -> LEFT
97 -> DOWN
98 -> RIGHT
*/

led_config_t g_led_config = {
  {

    {    0/*ESC*/,		1/*F1*/,	2/*F2*/,	4/*F4*/,	5/*F5*/,	6/*F6*/,	7/*F7*/,	9/*F9*/,	11/*F11*/,	    NO_LED,	        13/*HOME*/,	    14/*PGUp*/, NO_LED	            },
    {    18/*`*/,	    19/*1*/,	3/*F3*/,	23/*5*/,	25/*7*/,	26/*8*/,	8/*F8*/,	10/*F10*/,	12/*F12?*/,	    15/*NO_LED?*/,	16/*END*/,	    17/*PgDn*/,	NO_LED          	},
    {    36/*TAB*/,	    20/*2*/,	21/*3*/,	24/*6*/,	42/*Y*/,	27/*9*/,	28/*0*/,	30/*=*/,	31/*bckspc*/,	32/*NmLck*/,	33/*N/*/,	    34/***/,	35/*Prnt*/          },
    {    54/*CAPS*/,	37/*Q*/,	22/*4*/,	40/*R*/,	43/*U*/,	44/*I*/,	29/*-*/,	47/*[*/,	48/*]*/,	    50/*N7*/,	    51/*N8*/,	    52/*N9*/,	53/*N-*/            },
    {    71/*Shift*/,	38/*W*/,	39/*E*/,	41/*T*/,	60/*H*/,	45/*O*/,	46/*P*/,	64/*;*/,	49/*\\*/,	    67/*N4*/,	    68/*N5*/,	    69/*N6*/,	70/*N+*/	        },
    {    88/*ctrl*/,	55/*A*/,	57/*D*/,	58/*F*/,	61/*J*/,	62/*K*/,	63/*L*/,	80/*.*/,	65/*'*/,	    83/*N1*/,	    84/*N2*/,	    85/*N3*/,	87/*NRETURN*/		},
    {    89/*META*/,	56/*S*/,	73/*X*/,	59/*G*/,	76/*B*/,	78/*M*/,	79/*,*/,	81/*/*/,	66/*RETURN*/,	86/*UP*/,	    98/*RIGHT*/,    94/*N0*/,	95/*N.*/	        },
    {    90/*ALT*/,	    72/*Z*/,	74/*C*/,	75/*V*/,	91/*SPCE*/,	77/*N*/,	92/*RALT*/,	93/*FN*/,	82/*RSHIFT*/,	96/*LEFT*/,	    97/*DOWN*/,     NO_LED,	    NO_LED              }
  },
  {
	  {6, 61 },
	  {20, 61 },
	  {31, 61 },
	  {43, 61 },
	  {54, 61 },
	  {69, 61 },
	  {80, 61 },
	  {91, 61 },
	  {103, 61 },
	  {117, 61 },
	  {129, 61 },
	  {140, 61 },
	  {152, 61 },
	  {183, 61 },
	  {206, 61 },
	  {166, 61 },
	  {194, 61 },
	  {217, 61 },
	  {6, 49 },
	  {17, 49 },
	  {29, 49 },
	  {40, 49 },
	  {51, 49 },
	  {63, 49 },
	  {74, 49 },
	  {86, 49 },
	  {97, 49 },
	  {109, 49 },
	  {120, 49 },
	  {132, 49 },
	  {143, 49 },
	  {160, 49 },
	  {183, 49 },
	  {194, 49 },
	  {206, 49 },
	  {217, 49 },
	  {9, 39 },
	  {23, 39 },
	  {34, 39 },
	  {46, 39 },
	  {57, 39 },
	  {69, 39 },
	  {80, 39 },
	  {91, 39 },
	  {103, 39 },
	  {114, 39 },
	  {126, 39 },
	  {137, 39 },
	  {149, 39 },
	  {163, 39 },
	  {183, 39 },
	  {194, 39 },
	  {206, 39 },
	  {217, 39 },
	  {10, 29 },
	  {26, 29 },
	  {37, 29 },
	  {49, 29 },
	  {60, 29 },
	  {71, 29 },
	  {83, 29 },
	  {94, 29 },
	  {106, 29 },
	  {117, 29 },
	  {129, 29 },
	  {140, 29 },
	  {159, 29 },
	  {183, 29 },
	  {194, 29 },
	  {206, 29 },
	  {217, 29 },
	  {13, 20 },
	  {31, 20 },
	  {43, 20 },
	  {54, 20 },
	  {66, 20 },
	  {77, 20 },
	  {89, 20 },
	  {100, 20 },
	  {112, 19 },
	  {123, 20 },
	  {134, 20 },
	  {150, 20 },
	  {183, 20 },
	  {194, 20 },
	  {206, 20 },
	  {169, 17 },
	  {214, 12 },
	  {7, 10 },
	  {21, 10 },
	  {36, 10 },
	  {79, 10 },
	  {123, 10 },
	  {140, 10 },
	  {194, 10 },
	  {206, 10 },
	  {157, 7 },
	  {169, 7 },
	  {180, 7 },
	  {1, 63 },
	  {6, 64 },
	  {26, 64 },
	  {35, 64 },
	  {45, 64 },
	  {54, 64 },
	  {64, 64 },
	  {74, 64 },
	  {83, 64 },
	  {93, 64 },
	  {102, 64 },
	  {112, 64 },
	  {122, 64 },
	  {131, 64 },
	  {141, 64 },
	  {150, 64 },
	  {160, 64 },
	  {170, 64 },
	  {179, 64 },
	  {189, 64 },
	  {198, 64 },
	  {218, 64 },
	  {222, 63 },
	  {224, 58 },
	  {224, 51 },
	  {224, 43 },
	  {224, 35 },
	  {224, 28 },
	  {224, 20 },
	  {224, 12 },
	  {224, 5 },
	  {222, 0 },
	  {218, 0 },
	  {208, 0 },
	  {198, 0 },
	  {189, 0 },
	  {179, 0 },
	  {170, 0 },
	  {160, 0 },
	  {150, 0 },
	  {141, 0 },
	  {131, 0 },
	  {122, 0 },
	  {112, 0 },
	  {102, 0 },
	  {93, 0 },
	  {83, 0 },
	  {74, 0 },
	  {64, 0 },
	  {54, 0 },
	  {45, 0 },
	  {35, 0 },
	  {26, 0 },
	  {16, 0 },
	  {6, 0  },
	  {1, 0  },
	  {0, 5  },
	  {0, 12 },
	  {0, 20 },
	  {0, 28 },
	  {0, 35 },
	  {0, 43 },
	  {0, 51 },
	  {0, 58 },
	  {174, 61 },
	  {174, 58 },
	  {174, 55 }
  },
  {
 // Key Lights (99) - LED_FLAG_KEYLIGHT, LED_FLAG_MODIFIER
		4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
		4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
		4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
		4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
		1, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 1, 4, 4, 4, 4, 4,
		1, 1, 1, 4, 1, 1, 4, 4, 4, 4, 4,

// Underglow/border LEDs (64) - LED_FLAG_UNDERGLOW
		2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
		2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
		2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
		2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
		2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
		2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
		2, 2, 2, 2,

 // NCS Indicators (3)
		//0, 0, 0
		2, 2, 2
  }
};

#if defined(USB_LED_INDICATOR_ENABLE) || defined(DEDICATED_LED_INDICATOR_ENABLE)
void rgb_matrix_indicators_kb(void)
{
  led_matrix_indicators();
}
#endif // USB_LED_INDICATOR_ENABLE || DEDICATED_LED_INDICATOR_ENABLE

#endif
